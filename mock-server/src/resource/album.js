const MemoryCountResourceBuilder = require("./memoryCount");
const MemoryResourceBuilder = require("./memory");
// const resourceUtil = require("./resourceUtil");

module.exports = class AlbumResourceBuilder {
  constructor() {
    this.albumId = 1;
    this.title = "hogehoge";
    this.memories = [];
  }

  build() {
    return {
      album_id: this.albumId,
      title: this.title,
      memories: {
        memories: this.memories,
        memory_count: new MemoryCountResourceBuilder()
          .withMemoriesCount(this.memories.length)
          .withPublichedCount(this.memories.length)
          .build()
      }
    };
  }

  withAlbumId(id) {
    this.albumId = id;
    return this;
  }

  wishTitle(title) {
    this.title = title;
    return this;
  }

  /**
   * buildした配列を引数に取ります
   * @param {*} memories 
   */
  withMemories(memories) {
    this.memories = memories;
    return this;
  }

  /**
   * 指定された数だけmemoryを生成
   * 
   * @param {Number} count
   */
  withAutoGeneratedMemories(count) {
    // TODO: resourceUtil側がエラーになっちゃうので、直すまで愚直push
    // this.memories = resourceUtil.autoGenerateMemories(count);
    for(var i = 0; i < count; i++) {
      this.memories.push(new MemoryResourceBuilder()
        .withMemoryId(i + 1)
        .withAutoGeneratedPhotos(2)
        .withAutoGeneratedTags(2)
        .build());
    }
    return this;
  }

  appendMemory(memory) {
    this.memories.push(memory);
    return this;
  }
};